{"version":3,"sources":["components/modal.js","components/loading.js","components/chessGame.js","App.js","index.js"],"names":["Modal","children","visible","className","aria-hidden","Loading","text","restProps","useState","label","setLabel","setTimeout","length","socket","io","connect","transports","upgrade","chess","Chess","ChessGame","connecting","setConnecting","lastMove","setLastMove","pendingMove","setPendingMove","fen","setFen","selectVisible","setSelectVisible","on","useEffect","emit","newFen","randomMove","moves","verbose","move","Math","floor","random","san","from","to","turnColor","turn","width","height","movable","dests","Map","SQUARES","forEach","square","set","map","free","color","calcMovable","onMove","i","len","flags","indexOf","promotion","piece","onClick","App","ReactDOM","render","document","getElementById"],"mappings":"wNAEe,SAASA,EAAT,GAAuC,IAAtBC,EAAqB,EAArBA,SAC9B,OADmD,EAAXC,SAGpC,qBAAKC,UAAU,qCAAf,SACE,sBAAKA,UAAU,yFAAf,UACE,qBAAKA,UAAU,mCAAmCC,cAAY,OAA9D,SACE,qBAAKD,UAAU,8CAEjB,sBACEA,UAAU,qDACVC,cAAY,OAFd,oBAMA,sBAAKD,UAAU,kIAAf,UACE,uBAAMA,UAAU,kDAAhB,UACE,sBAAMA,UAAU,wFAChB,sBAAMA,UAAU,6DAElB,qBAAKA,UAAU,6CAAf,SACGF,Y,oBCpBA,SAASI,EAAT,GAA0C,IAAvBC,EAAsB,EAAtBA,KAASC,EAAa,0BAC5BC,mBAAS,IADmB,mBAC/CC,EAD+C,KACxCC,EADwC,KAQtD,OALAC,YAAW,WACLF,EAAMG,QAAU,EAAGF,EAAS,IAC3BA,EAASD,EAAQ,OACrB,KAGD,8CAAKN,UAAU,6BAAgCI,GAA/C,cACE,qBAAKJ,UAAU,+BACdG,EACAG,MCNP,IAAMI,EAASC,KAAGC,QAAQ,wBAAyB,CACjDC,WAAY,CAAC,aACbC,SAAS,IAGLC,EAAQ,IAAIC,IAEH,SAASC,IAAa,IAAD,EACEZ,oBAAS,GADX,mBAC3Ba,EAD2B,KACfC,EADe,OAEFd,qBAFE,mBAE3Be,EAF2B,KAEjBC,EAFiB,OAGIhB,qBAHJ,mBAG3BiB,EAH2B,KAGdC,EAHc,OAIZlB,mBAAS,IAJG,mBAI3BmB,EAJ2B,KAItBC,EAJsB,OAKQpB,oBAAS,GALjB,mBAK3BqB,EAL2B,KAKZC,EALY,KAOlCjB,EAAOkB,GAAG,WAAW,WACnBT,GAAc,MAIhBU,qBAAU,WACRnB,EAAOoB,KAAK,MAAON,KAClB,CAACA,IAGJK,qBAAU,WACRnB,EAAOkB,GAAG,OAAO,SAACG,GAChBN,EAAOM,QAER,CAACN,IAEJ,IAgBMO,EAAa,WACjB,IAAMC,EAAQlB,EAAMkB,MAAM,CAAEC,SAAS,IAC/BC,EAAOF,EAAMG,KAAKC,MAAMD,KAAKE,SAAWL,EAAMxB,SAChDwB,EAAMxB,OAAS,IACjBM,EAAMoB,KAAKA,EAAKI,KAChBd,EAAOV,EAAMS,OACbH,EAAY,CAACc,EAAKK,KAAML,EAAKM,OAc3BC,EAAY,WAChB,MAAwB,MAAjB3B,EAAM4B,OAAiB,QAAU,SAsB1C,OAAOzB,EACL,qBAAKlB,UAAU,qDAAf,SACE,cAACE,EAAD,CACEF,UAAU,6CACVG,KAAK,iBAIT,sBAAKH,UAAU,qDAAf,UACE,cAAC,IAAD,CACE4C,MAAM,OACNC,OAAO,OACPH,UAAWA,IACXI,QAhCc,WAClB,IAAMC,EAAQ,IAAIC,IAWlB,OAVAjC,EAAMkC,QAAQC,SAAQ,SAACC,GACrB,IAAMlB,EAAQlB,EAAMkB,MAAM,CAAEkB,SAAQjB,SAAS,IACzCD,EAAMxB,QACRsC,EAAMK,IACJD,EACAlB,EAAMoB,KAAI,SAAClB,GAAD,OAAUA,EAAKM,UAKxB,CACLa,MAAM,EACNP,QACAQ,MAAO,SAiBIC,GACTpC,SAAUA,EACVI,IAAKA,EACLiC,OA3ES,SAACjB,EAAMC,GAEpB,IADA,IAAMR,EAAQlB,EAAMkB,MAAM,CAAEC,SAAS,IAC5BwB,EAAI,EAAGC,EAAM1B,EAAMxB,OAAQiD,EAAIC,EAAKD,IAC3C,IAAqC,IAAjCzB,EAAMyB,GAAGE,MAAMC,QAAQ,MAAe5B,EAAMyB,GAAGlB,OAASA,EAG1D,OAFAjB,EAAe,CAACiB,EAAMC,SACtBd,GAAiB,GAIjBZ,EAAMoB,KAAK,CAAEK,OAAMC,KAAIqB,UAAW,QACpCrC,EAAOV,EAAMS,OACbH,EAAY,CAACmB,EAAMC,IACnBjC,WAAWwB,EAAY,SAiEvB,cAACnC,EAAD,CAAOE,QAAS2B,EAAhB,SACG,CAAC,IAAK,IAAK,IAAK,KAAK2B,KAAI,SAACU,GAAD,OACxB,qBAAK/D,UAAU,2HAAf,SACE,qBACEgE,QAAS,kBAvDH,SAACD,GACjB,IAAMvB,EAAOlB,EAAY,GACnBmB,EAAKnB,EAAY,GACvBP,EAAMoB,KAAK,CAAEK,OAAMC,KAAIqB,UAAWC,IAClCtC,EAAOV,EAAMS,OACbH,EAAY,CAACmB,EAAMC,IACnBd,GAAiB,GACjBnB,WAAWwB,EAAY,KAgDE8B,CAAUC,IACzB/D,UAAS,gBAAW0C,IAAX,YAA0BqB,EAA1B,qEACJA,aCtHJ,SAASE,IACtB,OACE,mCACE,cAAChD,EAAD,M,OCDNiD,IAASC,OACP,mCACE,cAACF,EAAD,MAEFG,SAASC,eAAe,W","file":"static/js/main.956377ab.chunk.js","sourcesContent":["import React from \"react\";\r\n\r\nexport default function Modal({ children, visible }) {\r\n  return (\r\n    visible && (\r\n      <div className=\"fixed z-10 inset-0 overflow-y-auto\">\r\n        <div className=\"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0\">\r\n          <div className=\"fixed inset-0 transition-opacity\" aria-hidden=\"true\">\r\n            <div className=\"absolute inset-0 bg-gray-500 opacity-75\"></div>\r\n          </div>\r\n          <span\r\n            className=\"hidden sm:inline-block sm:align-middle sm:h-screen\"\r\n            aria-hidden=\"true\"\r\n          >\r\n            &#8203;\r\n          </span>\r\n          <div className=\"inline-block bg-white border-2 border-blue-500 rounded-lg shadow-xl transform transition-all sm:my-8 sm:align-middle w-auto p-4\">\r\n            <span className=\"flex absolute h-4 w-4 top-0 right-0 -mt-1 -mr-1\">\r\n              <span className=\"animate-ping absolute inline-flex h-full w-full rounded-full bg-blue-500 opacity-75\"></span>\r\n              <span className=\"relative inline-flex rounded-full h-4 w-4 bg-blue-600\"></span>\r\n            </span>\r\n            <div className=\"flex justify-center items-center space-x-8\">\r\n              {children}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )\r\n  );\r\n}\r\n","import React, { useState } from \"react\";\r\n\r\nexport default function Loading({ text, ...restProps }) {\r\n  const [label, setLabel] = useState(\"\");\r\n\r\n  setTimeout(() => {\r\n    if (label.length >= 3) setLabel(\"\");\r\n    else setLabel(label + \".\");\r\n  }, 800);\r\n\r\n  return (\r\n    <div className=\"flex flex-col text-center\" {...restProps}>\r\n      <div className=\"loading-icon w-full h-full\" />\r\n      {text}\r\n      {label}\r\n    </div>\r\n  );\r\n}\r\n","import React, { useState, useEffect } from \"react\";\r\nimport { io } from \"socket.io-client\";\r\nimport Chess from \"chess.js\";\r\nimport Chessground from \"react-chessground\";\r\nimport \"react-chessground/dist/styles/chessground.css\";\r\nimport Modal from \"./modal\";\r\nimport Loading from \"./loading\";\r\n\r\nconst socket = io.connect(\"http://localhost:4000\", {\r\n  transports: [\"websocket\"],\r\n  upgrade: false,\r\n});\r\n\r\nconst chess = new Chess();\r\n\r\nexport default function ChessGame() {\r\n  const [connecting, setConnecting] = useState(true);\r\n  const [lastMove, setLastMove] = useState();\r\n  const [pendingMove, setPendingMove] = useState();\r\n  const [fen, setFen] = useState(\"\");\r\n  const [selectVisible, setSelectVisible] = useState(false);\r\n\r\n  socket.on(\"connect\", () => {\r\n    setConnecting(false);\r\n  });\r\n\r\n  // Send fen to server\r\n  useEffect(() => {\r\n    socket.emit(\"msg\", fen);\r\n  }, [fen]);\r\n\r\n  // Recieve fen from server\r\n  useEffect(() => {\r\n    socket.on(\"msg\", (newFen) => {\r\n      setFen(newFen);\r\n    });\r\n  }, [setFen]);\r\n\r\n  const onMove = (from, to) => {\r\n    const moves = chess.moves({ verbose: true });\r\n    for (let i = 0, len = moves.length; i < len; i++) {\r\n      if (moves[i].flags.indexOf(\"p\") !== -1 && moves[i].from === from) {\r\n        setPendingMove([from, to]);\r\n        setSelectVisible(true);\r\n        return;\r\n      }\r\n    }\r\n    if (chess.move({ from, to, promotion: \"x\" })) {\r\n      setFen(chess.fen());\r\n      setLastMove([from, to]);\r\n      setTimeout(randomMove, 500);\r\n    }\r\n  };\r\n\r\n  const randomMove = () => {\r\n    const moves = chess.moves({ verbose: true });\r\n    const move = moves[Math.floor(Math.random() * moves.length)];\r\n    if (moves.length > 0) {\r\n      chess.move(move.san);\r\n      setFen(chess.fen());\r\n      setLastMove([move.from, move.to]);\r\n    }\r\n  };\r\n\r\n  const promotion = (piece) => {\r\n    const from = pendingMove[0];\r\n    const to = pendingMove[1];\r\n    chess.move({ from, to, promotion: piece });\r\n    setFen(chess.fen());\r\n    setLastMove([from, to]);\r\n    setSelectVisible(false);\r\n    setTimeout(randomMove, 500);\r\n  };\r\n\r\n  const turnColor = () => {\r\n    return chess.turn() === \"w\" ? \"white\" : \"black\";\r\n  };\r\n\r\n  const calcMovable = () => {\r\n    const dests = new Map();\r\n    chess.SQUARES.forEach((square) => {\r\n      const moves = chess.moves({ square, verbose: true });\r\n      if (moves.length) {\r\n        dests.set(\r\n          square,\r\n          moves.map((move) => move.to)\r\n        );\r\n      }\r\n    });\r\n\r\n    return {\r\n      free: false,\r\n      dests,\r\n      color: \"white\",\r\n    };\r\n  };\r\n\r\n  return connecting ? (\r\n    <div className=\"h-screen w-screen flex justify-center items-center\">\r\n      <Loading\r\n        className=\"w-32 h-32 text-blue-600 font-bold text-2xl\"\r\n        text=\"Connecting\"\r\n      />\r\n    </div>\r\n  ) : (\r\n    <div className=\"bg-white h-screen flex justify-center items-center\">\r\n      <Chessground\r\n        width=\"40vw\"\r\n        height=\"40vw\"\r\n        turnColor={turnColor()}\r\n        movable={calcMovable()}\r\n        lastMove={lastMove}\r\n        fen={fen}\r\n        onMove={onMove}\r\n      />\r\n      <Modal visible={selectVisible}>\r\n        {[\"q\", \"r\", \"b\", \"n\"].map((piece) => (\r\n          <div className=\"group flex justify-center items-center w-24 h-24 transition-all rounded-full transform hover:bg-blue-500 hover:scale-110\">\r\n            <div\r\n              onClick={() => promotion(piece)}\r\n              className={`piece ${turnColor()}-${piece} w-5/6 h-5/6 transition-all transform group-hover:-translate-y-1`}\r\n              key={piece}\r\n            />\r\n          </div>\r\n        ))}\r\n      </Modal>\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport ChessGame from \"./components/chessGame\";\r\n\r\nexport default function App() {\r\n  return (\r\n    <>\r\n      <ChessGame />\r\n    </>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport App from \"./App\";\r\nimport \"./index.css\";\r\n\r\nReactDOM.render(\r\n  <>\r\n    <App />\r\n  </>,\r\n  document.getElementById(\"root\")\r\n);\r\n"],"sourceRoot":""}